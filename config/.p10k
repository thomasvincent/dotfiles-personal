#!/usr/bin/env zsh

# Configures the Powerlevel10k prompt for Zsh to enhance usability and productivity.
# Displays dynamic system information and development environment status, optimized for macOS.

# Author: Thomas Vincent
# Date: 2024-05-15
# Repository: 5ttps://github.com/thomasvincent/dotfiles-personal
# License: MIT License

# For installation details and usage, refer to README.md in the repository.

# Ensure the script is running in a compatible Zsh environment
if [[ $ZSH_VERSION != 5.* ]]; then
  echo "Incompatible Zsh version. Powerlevel10k requires Zsh 5.x. Current version: $ZSH_VERSION"
  exit 1
fi

# Function to load Powerlevel10k configuration
load_p10k_config() {
  local config_file="${HOME}/.p10k.zsh"
  if [[ -f "${config_file}" ]]; then
    source "${config_file}"
  else
    echo "Powerlevel10k configuration file not found at ${config_file}. Please install Powerlevel10k."
    exit 1
  fi
}

# Initialize Powerlevel10k configuration
load_p10k_config

# Configure transient and instant prompt behaviors
typeset -g POWERLEVEL9K_TRANSIENT_PROMPT=always
typeset -g POWERLEVEL9K_INSTANT_PROMPT=quiet

# Define left and right prompt elements
typeset -g POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(dir vcs status command_execution_time)
typeset -g POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(kubecontext docker_machine background_jobs time battery ram load)

# Detailed configuration for prompt elements
typeset -g POWERLEVEL9K_SHORTEN_DIR_LENGTH=2
typeset -g POWERLEVEL9K_SHORTEN_STRATEGY=truncate_to_unique
typeset -g POWERLEVEL9K_DIR_MIN_COMMAND_COLUMNS=40
typeset -g POWERLEVEL9K_DIR_TRUNCATE_BEFORE_MARKER=true
typeset -g POWERLEVEL9K_DIR_SHOW_WRITABLE=true
typeset -g POWERLEVEL9K_VCS_CLEAN_FOREGROUND='green'
typeset -g POWERLEVEL9K_VCS_MODIFIED_FOREGROUND='yellow'
typeset -g POWERLEVEL9K_VCS_UNTRACKED_FOREGROUND='red'
typeset -g POWERLEVEL9K_VCS_LOADING_FOREGROUND='gray'
typeset -g POWERLEVEL9K_KUBECONTEXT_DEFAULT_FOREGROUND='cyan'
typeset -g POWERLEVEL9K_KUBECONTEXT_DEFAULT_CONTENT_EXPANSION=' $P9K_CONTENT'
typeset -g POWERLEVEL9K_DOCKER_MACHINE_FOREGROUND='blue'
typeset -g POWERLEVEL9K_TIME_FORMAT='%D{%H:%M:%S}'
typeset -g POWERLEVEL9K_BATTERY_DISCONNECTED_FOREGROUND='gray'
typeset -g POWERLEVEL9K_BATTERY_CHARGING_FOREGROUND='green'
typeset -g POWERLEVEL9K_BATTERY_CHARGED_FOREGROUND='green'
typeset -g POWERLEVEL9K_BATTERY_LOW_THRESHOLD=20
typeset -g POWERLEVEL9K_BATTERY_LOW_FOREGROUND='red'
typeset -g POWERLEVEL9K_RAM_FOREGROUND='magenta'
typeset -g POWERLEVEL9K_LOAD_CRITICAL_FOREGROUND='red'
